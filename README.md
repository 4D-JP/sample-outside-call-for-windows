# sample-outside-call-for-windows
外部からODBCを利用して任意のタイミングで、4D Serverに処理させるサンプルデータベースです。

ODBCから４Ｄにイベントを送る方法の例題です。

特に、４ＤのバックアップをWindowのタスクスケジューラーから起動する方法について考えて作成してありますが、他にも利用が可能だと思います。

サンプルを試すには、次のようにしてください。

*前準備：*

１）バージョンに合う ODBC for 4D Server ドライバーをインストールする

*利用方法：*

１）サンプルを展開し、4D Serverで起動する

２）サンプルデータベースのバックアップ設定を行い、バックアップを手動で試し、バックアップが動作するかを確認する

３）WindowsのシステムDNS（64bit環境の場合には64bitのデータソースマネージャーを使います）に、ODBC for 4D Server ドライバーを使い「test_4d」という名称のデータソースを登録する

４）サンプルデータベースの中にある「Scripts」フォルダ内の「set_startBackup.js」をタスクスケジューラーに登録

上記のようにしてセットアップされれば、タスクスケジューラーでセットされた時間にバックアップされます。

仕組みは、次のようになっています。

１）set_startBackup.jsにより、４Ｄ内のEvent_Logテーブルにレコードが書き込まれる

２）Event_Logテーブルのトリガーにより４Ｄのメソッド「Method_outside_call」が起動される

３）Method_outside_callによりイベントが処理される

動作が上手く行かないときには、「Scripts」フォルダ内の「set_test.js」をダブルクリックして、Event_Logテーブルにレコードが書き込まれるかを確認してください。

この方法の利点は…

１）イベントがレコードとして記録されるので動作の確認がし易い

２）イベント処理はフィールドの値を元に行われるので、外部からの様々なイベントを処理できるように拡張が可能

注意点は、SQLサーバーのライセンスがインストールされていない時には、クライアントのライセンスがイベント処理実行の時に１つ利用されます。
